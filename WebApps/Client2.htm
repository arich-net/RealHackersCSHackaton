<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blockchain - client view</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <style>
        #loader {
            border: 16px solid #f3f3f3;
            border-top: 16px solid #3498db;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="display-4">Mortage online</h1>
        <div id="loader" style="display:none"></div>
        <hr class="my-4">
        <form>
            <div class="form-group">
                <label for="fname">First Name</label>
                <input type="text" class="form-control" id="fname" placeholder="Your name..">
            </div>
            <div class="form-group">
                <label for="lname">Last Name</label>
                <input type="text" class="form-control" id="lname" placeholder="Your last name..">
            </div>
            <div class="form-group">
                <label for="loan2">Loan</label>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="300'000" aria-label="input loan amount" aria-describedby="loan2">
                    <div class="input-group-append">
                        <span class="input-group-text" id="loan2">CHF</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" class="form-control" id="address" placeholder="Uetlihof 13, Zuerich">
            </div>
            <div class="form-group">
                <label for="credit">Credit history
                </label>
                <div class="input-group mb-3">
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="credit">
                        <label class="custom-file-label" for="credit">Choose file</label>
                    </div>
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="button">Upload</button>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="subject">Property description
                </label>
                <div class="input-group mb-3">
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="subject">
                        <label class="custom-file-label" for="subject">Choose file</label>
                    </div>
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="button">Upload</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-info" type="submit">Submit</button>
        </form>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <script src="scripts/login.js"></script>
    <script>
        $(document).ready(function () {
            var sessionToken;
            window.onload = function () {
                sessionToken = verifySessionToken();
                if (sessionToken == false) {
                    window.location.replace("Login.htm");
                }
            };

            $("form").submit(function (event) {
                event.preventDefault();
                $('#loader').css({ "position": "absolute", "left": "50%", "top": "50%" });
                sendForm();
            });

            function sendForm() {
                var uniqueId = String.fromCharCode(65 + Math.floor(Math.random() * 26)) + Date.now();
                
                var posting = $.ajax({
                    type: 'post',
                    url: "https://blockchain.arich-net.com/api/Customer",
                    data: {
                        "$class": "org.real.hackers.Customer",
                        "customerId": uniqueId,
                        "firstName": $("#fname").val(),
                        "lastName": $("#lname").val(),
                        "dateOfBirth": "1979-03-16T20:17:54.264Z"
                    },
                    contentType: 'json',
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader('X-Access-Token', sessionToken);
                    },
                    success: function (response) {
                        console.log(response);
                    },
                    error: function (error) {
                        console.log(error);
                    }
                });
            }
        });

    </script>


</body>